name: Release Notification To Slack

on:
  workflow_dispatch:

jobs:
  get_release_notes:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - name: Get latest release notes
        run: |
          release_info=$(curl -H "Accept: application/vnd.github.v3+json" https://api.github.com/repos/jaehwaa/github-actions/releases/latest)
          release_notes=$(echo $release_info | jq -r '.body')
          echo "ìµœê·¼ ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ ì •ë³´:"
          echo ::set-output name=release_notes::$release_notes

      - name: Slack Notification
        run: |
          MSG="{ \"text\": \"ðŸš€ ìµœì‹  ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸: ${{ steps.get_release_notes.outputs.release_notes }}\" }"
          curl -X POST -H 'Content-type: application/json' --data "${MSG}" "${{ secrets.slack_webhook_url }}"