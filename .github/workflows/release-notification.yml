name: Release Notification To Slack

on:
  workflow_dispatch:

jobs:
  get_release_notes:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - name: Get latest release notes
        id: get_release_notes
        run: |
          release_info=$(curl -H "Accept: application/vnd.github.v3+json" https://api.github.com/repos/jaehwaa/github-actions/releases/latest)
          release_notes=$(echo $release_info | jq -r '.body')
          echo "최근 릴리스 노트 정보:"
          echo ::set-output name=release_notes::$release_notes

      - name: Slack Notification
        uses: rtCamp/action-slack-notify@v2
        env:
          SLACK_WEBHOOK: ${{ secrets.slack_webhook_url }}
          SLACK_MESSAGE: ${{ steps.get_release_notes.outputs.release_notes }}